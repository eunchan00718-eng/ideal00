<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ideal | AI Perfume Search</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Pretendard:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root {
            --primary-pink: #ffccd5;
            --text-dark: #333;
        }

        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10vh;
            min-height: 100vh;
            /* ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì •: íˆ¬ëª…ë„ ì¡°ì ˆì„ ìœ„í•´ linear-gradientì™€ ì„ìŒ */
            background: linear-gradient(rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2)), 
                        url('Gemini_Generated_Image_yyx2ecyyx2ecyyx2.jpg') no-repeat center center fixed;
            background-size: cover;
            font-family: 'Pretendard', sans-serif;
            color: var(--text-dark);
        }

        /* ë¡œê·¸ì¸ ì˜ì—­ */
        .top-right-container { position: absolute; top: 20px; right: 20px; z-index: 1000; }
        #user-info { display: none; background: rgba(255, 255, 255, 0.9); padding: 8px 15px; border-radius: 30px; font-size: 14px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }

        /* ë¡œê³  ë° í—¤ë” */
        .sub-header { color: rgba(0, 0, 0, 0.6); font-size: 14px; margin-bottom: 8px; font-weight: 500; }
        .logo { font-family: 'Dancing Script', cursive; font-size: clamp(60px, 15vw, 100px); font-weight: 700; margin-bottom: 30px; cursor: pointer; transition: transform 0.3s ease; }
        .logo:hover { transform: scale(1.05); }

        /* ê²€ìƒ‰ì°½ ì˜ì—­ */
        .search-wrapper { width: 90%; max-width: 600px; text-align: center; }
        .search-box { 
            position: relative;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 40px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            padding: 5px;
        }
        .search-input { 
            flex: 1;
            padding: 15px 30px;
            font-size: 18px;
            border: none;
            background: transparent;
            outline: none;
        }
        .search-btn {
            background: #ff85a1;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            margin-right: 5px;
        }

        /* ê²°ê³¼ í‘œì‹œ ì˜ì—­ */
        #result-area { 
            width: 100%;
            margin-top: 25px;
            padding: 30px;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.95);
            display: none;
            line-height: 1.8;
            box-shadow: 0 15px 35px rgba(0,0,0,0.08);
            text-align: left;
            border: 1px solid var(--primary-pink);
        }
        .ai-title { color: #ff85a1; font-weight: bold; font-size: 20px; margin-bottom: 15px; display: block; }
    </style>
</head>
<body>

    <div class="top-right-container">
        <div id="g_id_onload" data-client_id="4623512319-0hrosa9j6l01rcgmi2aep1vd768f3o1u.apps.googleusercontent.com" data-callback="handleCredentialResponse"></div>
        <div class="g_id_signin" data-type="standard"></div>
        <div id="user-info"><span id="user-name"></span></div>
    </div>

    <p class="sub-header">ë‚˜ë³´ë‹¤ ë‚˜ë¥¼ ë” ì˜ ì•„ëŠ” AIê°€ ì¶”ì²œí•´ì£¼ëŠ” ì´ìƒì ì¸ í–¥ìˆ˜</p>
    <h1 class="logo" onclick="location.reload()">ideal</h1>

    <div class="search-wrapper">
        <div class="search-box">
            <input type="text" id="userInput" class="search-input" placeholder="ì–´ë–¤ ë¶„ìœ„ê¸°ë¥¼ ì°¾ê³  ìˆë‹ˆ? (ì˜ˆ: ìƒˆë²½ ê³µê¸°, ì‹œí¬í•œ)" onkeypress="if(event.key==='Enter') askGemini()">
            <button class="search-btn" onclick="askGemini()">ê²€ìƒ‰</button>
        </div>
        <div id="result-area">
            <span class="ai-title">ğŸŒ¸ ideal ì¶”ì²œ</span>
            <div id="ai-content"></div>
        </div>
    </div>

    <script>
        // âš ï¸ ì£¼ì˜: ì—¬ê¸°ì— ì‹¤ì œ ë³¸ì¸ì˜ API í‚¤ë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.
        const GEMINI_API_KEY = "AIzaSyBlcMHfU9l_JMpiIjEU5lAyvU-A93YKy8Y"; 

        async function askGemini() {
            const input = document.getElementById('userInput').value.trim();
            const aiContent = document.getElementById('ai-content');
            const resultArea = document.getElementById('result-area');

            if(!input) {
                alert("ë¶„ìœ„ê¸°ë¥¼ ì…ë ¥í•´ì¤˜! ğŸ˜Š");
                return;
            }

            // UI ìƒíƒœ ì—…ë°ì´íŠ¸
            resultArea.style.display = "block";
            aiContent.innerHTML = "<b>ë„ˆì˜ ë¬´ë“œë¥¼ ë¶„ì„í•˜ê³  ìˆì–´... âœ¨</b>";

            // ğŸ› ï¸ 404 ì—ëŸ¬ ë°©ì§€ë¥¼ ìœ„í•œ ìˆ˜ì •ëœ API ì—”ë“œí¬ì¸íŠ¸ (v1beta ì‚¬ìš©)
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;

            try {
                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `ë„ˆëŠ” í–¥ìˆ˜ íë ˆì´í„°ì•¼. '${input}'ì´ë¼ëŠ” í‚¤ì›Œë“œë‚˜ ë¶„ìœ„ê¸°ì— ì–´ìš¸ë¦¬ëŠ” í–¥ìˆ˜ë¥¼ í•˜ë‚˜ ì¶”ì²œí•´ì¤˜. ë¸Œëœë“œëª…ê³¼ ì œí’ˆëª…ì„ ëª…í™•íˆ ì•Œë ¤ì£¼ê³ , ì™œ ì´ í–¥ìˆ˜ê°€ ì˜ ì–´ìš¸ë¦¬ëŠ”ì§€ ì¹œì ˆí•˜ê²Œ ë°˜ë§ë¡œ ì„¤ëª…í•´ì¤˜.`
                            }]
                        }]
                    })
                });

                const data = await response.json();

                // ì„œë²„ì—ì„œ ì—ëŸ¬ë¥¼ ë³´ë‚¸ ê²½ìš° ì²˜ë¦¬
                if (data.error) {
                    throw new Error(data.error.message);
                }

                // ê²°ê³¼ í…ìŠ¤íŠ¸ ì¶”ì¶œ ë° í™”ë©´ í‘œì‹œ (íŠ¹ìˆ˜ë¬¸ì ì œê±°)
                const resultText = data.candidates[0].content.parts[0].text.replace(/[*#]/g, '');
                aiContent.innerText = resultText;

            } catch (error) {
                console.error("Error details:", error);
                aiContent.innerHTML = `<span style="color:red;">ì•—, ë¬¸ì œê°€ ìƒê²¼ì–´! ğŸ˜¥<br>ì˜¤ë¥˜ ë‚´ìš©: ${error.message}<br>API í‚¤ê°€ ì •í™•í•œì§€ ë‹¤ì‹œ í™•ì¸í•´ì¤˜!</span>`;
            }
        }

        // êµ¬ê¸€ ë¡œê·¸ì¸ ì²˜ë¦¬
        function handleCredentialResponse(r) {
            const p = parseJwt(r.credential);
            document.getElementById('user-name').innerText = p.name + "ë‹˜, í™˜ì˜í•´! ğŸ‘‹";
            document.getElementById('user-info').style.display = 'block';
            document.querySelector('.g_id_signin').style.display = 'none';
        }

        function parseJwt(t){var r=t.split(".")[1],n=r.replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(window.atob(n).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}
    </script>
</body>
</html>