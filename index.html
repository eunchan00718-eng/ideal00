<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ideal | AI Perfume Search</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Pretendard:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <style>
        body {
            margin: 0; display: flex; flex-direction: column; align-items: center; padding-top: 10vh;
            background-image: url('Gemini_Generated_Image_yyx2ecyyx2ecyyx2.png'); 
            background-size: cover; background-position: center; background-attachment: fixed;
            font-family: 'Pretendard', sans-serif; min-height: 100vh;
        }

        /* ìš°ì¸¡ ìƒë‹¨ ìœ ì € ì˜ì—­ */
        .top-right-container { position: absolute; top: 20px; right: 20px; z-index: 1000; display: flex; align-items: center; gap: 10px; }
        
        #user-info { 
            display: none; background: rgba(255, 255, 255, 0.9); padding: 5px 12px; 
            border-radius: 30px; font-size: 13px; align-items: center; gap: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #user-pic { width: 30px; height: 30px; border-radius: 50%; object-fit: cover; border: 1px solid #eee; }

        /* ë¡œê³  ë””ìì¸ (ê²€ì • í•„ê¸°ì²´ + í°ìƒ‰ ì™¸ê³½ì„ ) */
        .logo { 
            font-family: 'Dancing Script', cursive; font-size: clamp(50px, 15vw, 90px); 
            font-weight: 700; color: #000; margin-bottom: 25px; text-align: center;
            text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff;
            cursor: pointer;
        }

        .sub-header { color: rgba(0, 0, 0, 0.6); font-size: clamp(11px, 3vw, 13px); margin-bottom: 10px; text-align: center; padding: 0 20px; }
        .search-wrapper { width: 90%; max-width: 580px; position: relative; }
        .search-box { display: flex; align-items: center; background: rgba(255, 255, 255, 0.9); border-radius: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .search-input { width: 100%; padding: 15px 55px 15px 25px; font-size: 16px; border: 1px solid #dfe1e5; border-radius: 30px; outline: none; background: transparent; }
        .search-icon { position: absolute; right: 20px; color: #9aa0a6; cursor: pointer; }

        /* ê²°ê³¼ì°½ ë° í•˜íŠ¸ ë²„íŠ¼ */
        #result-area { 
            width: 100%; margin-top: 20px; padding: 25px; border-radius: 20px; 
            background: rgba(255, 255, 255, 0.95); display: none; position: relative;
            line-height: 1.8; color: #3c4043; border: 1px solid #eee; box-shadow: 0 4px 20px rgba(0,0,0,0.1); 
        }
        .heart-btn { 
            position: absolute; top: 20px; right: 20px; font-size: 24px; cursor: pointer; 
            color: #ccc; transition: transform 0.2s; 
        }
        .heart-btn.active { color: #ff4b2b; transform: scale(1.2); }

        #rotateMsg { margin-top: 20px; text-align: center; color: rgba(0, 0, 0, 0.6); font-size: 13px; }
        .options { margin-top: 40px; text-align: center; }
        .options a { display: block; color: #1a0dab; text-decoration: none; font-size: 13px; margin-bottom: 12px; cursor: pointer; }

        @media (max-width: 600px) {
            body { padding-top: 15vh; }
            .top-right-container { top: 15px; right: 15px; scale: 0.85; }
        }
    </style>
</head>
<body>

    <div class="top-right-container">
        <div id="g_id_onload" 
             data-client_id="4623512319-mergahsri0chgr06sqnh3d8fh7igmj59.apps.googleusercontent.com" 
             data-callback="handleCredentialResponse">
        </div>
        <div class="g_id_signin" data-type="standard"></div>
        
        <div id="user-info">
            <img id="user-pic" src="" alt="Profile">
            <span id="user-name"></span>
        </div>
    </div>

    <div class="sub-header">ë‚˜ë³´ë‹¤ ë‚˜ë¥¼ ë” ì˜ ì•„ëŠ” AIê°€ ì¶”ì²œí•´ì£¼ëŠ” ì´ìƒì ì¸ í–¥ìˆ˜ ê²€ìƒ‰ ì›¹ ì‚¬ì´íŠ¸</div>
    <div class="logo" onclick="location.reload()">ideal</div>

    <div class="search-wrapper">
        <div class="search-box">
            <input type="text" id="userInput" class="search-input" placeholder="ë„ˆì˜ ë¶„ìœ„ê¸°ë¥¼ í•œ ë‹¨ì–´ë¡œ ë§í•´ë´" oninput="checkInput()">
            <svg class="search-icon" onclick="askGemini()" viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
            </svg>
        </div>
        
        <div id="result-area">
            <div class="heart-btn" id="heart" onclick="toggleSave()">â™¥</div>
            <div id="ai-content"></div>
        </div>
        
        <div id="rotateMsg">ë‚˜ ìì‹ ì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¨ì–´ë‚˜ ë¬¸ì¥ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.</div>
    </div>

    <div class="options">
        <a onclick="quickSearch('ë‹¤ë¥¸ ì‚¬ëŒì˜ ê´€ì ì—ì„œ ë³´ëŠ” ë‚˜ì—ê²Œ ì–´ìš¸ë¦¬ëŠ” í–¥ ì•Œì•„ë³´ê¸°')">ë‹¤ë¥¸ ì‚¬ëŒì˜ ê´€ì ì—ì„œ ë³´ëŠ” ë‚˜ì—ê²Œ ì–´ìš¸ë¦¬ëŠ” í–¥ ì•Œì•„ë³´ê¸°</a>
        <a onclick="quickSearch('ë‚˜ë¥¼ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸ ì•Œë ¤ì¤˜')">Geminiê°€ ì•Œë ¤ì£¼ëŠ” ë‚˜ë¥¼ í‘œí˜„í•  ìˆ˜ ìˆëŠ” í‚¤ì›Œë“œ ë¦¬ìŠ¤íŠ¸</a>
    </div>

    <script>
        // [100ë²ˆ ì¤„ ê·¼ì²˜] Gemini API í‚¤ ì…ë ¥ ìë¦¬
        const GEMINI_API_KEY = "AIzaSyAE3gjxuoEdNYkHai3u5LcZDazUozQmCXs"; 

        let currentResult = ""; // í˜„ì¬ ì¶”ì²œëœ ë‚´ìš©ì„ ì €ì¥í•  ë³€ìˆ˜

        async function askGemini() {
            const input = document.getElementById('userInput').value;
            const resultArea = document.getElementById('result-area');
            const aiContent = document.getElementById('ai-content');
            const heart = document.getElementById('heart');

            if(!input) return;

            resultArea.style.display = "block";
            aiContent.innerHTML = "<b>ë„ˆì˜ ì´ë¯¸ì§€ë¥¼ ë¶„ì„ ì¤‘ì´ì•¼... âœ¨</b>";
            heart.classList.remove('active'); // ìƒˆ ê²€ìƒ‰ ì‹œ í•˜íŠ¸ ì´ˆê¸°í™”

            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;

            try {
                const response = await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `ë„ˆëŠ” 21ì‚´ ì¹œí•œ ì–¸ë‹ˆ ì»¨ì…‰ì˜ í–¥ìˆ˜ ì „ë¬¸ê°€ì•¼. '${input}' ë¶„ìœ„ê¸°ì— ì°°ë–¡ì¸ í–¥ìˆ˜ í•˜ë‚˜ë¥¼ ì¶”ì²œí•´ì£¼ê³  ì¹œê·¼í•œ ë°˜ë§ë¡œ ì„¤ëª…í•´ì¤˜. êµ¬ë§¤ ë§í¬(ë„¤ì´ë²„ ì‡¼í•‘, ì¿ íŒ¡ ë“±)ë„ í¬í•¨í•´ì¤˜. ë‹µë³€ ì‹œì‘ì€ 'ë‚˜ì˜ ì¶”ì²œ'ìœ¼ë¡œ í•´.` }] }]
                    })
                });

                const data = await response.json();
                currentResult = data.candidates[0].content.parts[0].text.replace(/[*#]/g, '');
                aiContent.innerHTML = `<div style="font-weight: bold; font-size: 1.1em; margin-bottom: 10px; color: #4285F4;">ğŸŒ¸ ë‚˜ì˜ ì¶”ì²œ</div>${currentResult}`;
            } catch (error) {
                aiContent.innerHTML = "ì•—, ì—ëŸ¬ê°€ ë‚¬ì–´! í‚¤ í™•ì¸ ë¶€íƒí•´. ğŸ˜¢";
            }
        }

        // ì°œí•˜ê¸° ê¸°ëŠ¥ (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥)
        function toggleSave() {
            const heart = document.getElementById('heart');
            heart.classList.toggle('active');
            
            if (heart.classList.contains('active')) {
                localStorage.setItem('savedPerfume', currentResult);
                alert("ì´ í–¥ìˆ˜ë¥¼ ì°œí–ˆì–´! ë‚˜ì¤‘ì— ë‹¤ì‹œ ë³¼ ìˆ˜ ìˆê²Œ ì €ì¥í•´ë‘˜ê²Œ. ğŸ˜‰");
            } else {
                localStorage.removeItem('savedPerfume');
            }
        }

        function handleCredentialResponse(response) {
            const payload = parseJwt(response.credential);
            document.getElementById('user-name').innerText = payload.name + "ë‹˜, ì•ˆë…•! ğŸ‘‹";
            document.getElementById('user-pic').src = payload.picture;
            document.getElementById('user-info').style.display = 'flex';
            document.querySelector('.g_id_signin').style.display = 'none';
        }

        function parseJwt(t){var r=t.split(".")[1],n=r.replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(window.atob(n).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}
        function checkInput(){if(!document.getElementById('userInput').value)document.getElementById('result-area').style.display="none"}
        function quickSearch(t){document.getElementById('userInput').value=t;askGemini()}
        document.getElementById('userInput').addEventListener('keypress',e=>{if("Enter"===e.key)askGemini()});

        const msgs = ["ë‚˜ ìì‹ ì„ ë‚˜íƒ€ë‚´ëŠ” ë‹¨ì–´ë‚˜ ë¬¸ì¥ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.", "ê´€ì‹¬ìˆëŠ” ì´ì„±ì´ ì¢‹ì•„í• ë§Œí•œ í–¥ìˆ˜ ë°”ë¡œ ì°¾ê¸°", "Geminiê°€ ì•Œë ¤ì£¼ëŠ” ì–´ìš¸ë¦¬ëŠ” í–¥ê¸°"];
        let idx = 0; setInterval(() => { idx = (idx + 1) % msgs.length; const msgEl = document.getElementById('rotateMsg'); msgEl.style.opacity = 0; setTimeout(() => { msgEl.innerText = msgs[idx]; msgEl.style.opacity = 1; }, 500); }, 3000);
    </script>
</body>
</html>